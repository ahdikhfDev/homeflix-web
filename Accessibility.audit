{"type":"test-group","name":"Accessibility","description":"Diagnoses common accessibility problems affecting screen readers and other assistive technology.","tests":[{"type":"test-case","name":"testMenuRoleForRequiredChildren","description":"Ensure that elements of role “menu” and “menubar” have required owned elements in accordance with WAI-ARIA.","supports":1,"test":"function() {\n    const relationships = {\n        menu: [\"menuitem\", \"menuitemcheckbox\", \"menuitemradio\"],\n        menubar: [\"menuitem\", \"menuitemcheckbox\", \"menuitemradio\"],\n    };\n    let domNodes = [];\n    let visitedParents = new Set;\n    function hasChildWithRole(node, expectedRoles) {\n        let childNode = node;\n        if (!childNode)\n            return false;\n\n        if (childNode.parentNode)\n            visitedParents.add(childNode.parentNode);\n\n        while (childNode) {\n            let properties = WebInspectorAudit.Accessibility.getComputedProperties(childNode);\n            if (childNode.nodeType === Node.ELEMENT_NODE && properties) {\n                if (expectedRoles.includes(properties.role))\n                    return true;\n\n                if (childNode.hasChildNodes() && hasChildWithRole(childNode.firstChild, expectedRoles))\n                    return true;\n            }\n            childNode = childNode.nextSibling;\n        }\n        return false;\n    }\n    for (let role in relationships) {\n        for (let parentNode of WebInspectorAudit.Accessibility.getElementsByComputedRole(role)) {\n            if (visitedParents.has(parentNode))\n                continue;\n\n            if (!hasChildWithRole(parentNode.firstChild, relationships[role]))\n                domNodes.push(parentNode);\n        }\n    }\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testGridRoleForRequiredChildren","description":"Ensure that elements of role “grid” have required owned elements in accordance with WAI-ARIA.","supports":1,"test":"function() {\n    const relationships = {\n        grid: [\"row\", \"rowgroup\"],\n    };\n    let domNodes = [];\n    let visitedParents = new Set;\n    function hasChildWithRole(node, expectedRoles) {\n        let childNode = node;\n        if (!childNode)\n            return false;\n\n        if (childNode.parentNode)\n            visitedParents.add(childNode.parentNode);\n\n        while (childNode) {\n            let properties = WebInspectorAudit.Accessibility.getComputedProperties(childNode);\n            if (childNode.nodeType === Node.ELEMENT_NODE && properties) {\n                if (expectedRoles.includes(properties.role))\n                    return true;\n\n                if (childNode.hasChildNodes() && hasChildWithRole(childNode.firstChild, expectedRoles))\n                    return true;\n            }\n            childNode = childNode.nextSibling;\n        }\n        return false;\n    }\n    for (let role in relationships) {\n        for (let parentNode of WebInspectorAudit.Accessibility.getElementsByComputedRole(role)) {\n            if (visitedParents.has(parentNode))\n                continue;\n\n            if (!hasChildWithRole(parentNode.firstChild, relationships[role]))\n                domNodes.push(parentNode);\n        }\n    }\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testForAriaLabelledBySpelling","description":"Ensure that “aria-labelledby” is spelled correctly.","supports":1,"test":"function() {\n    let domNodes = Array.from(document.querySelectorAll(\"[aria-labeledby]\"));\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"aria-labeledby\"]};\n}"},{"type":"test-case","name":"testForMultipleBanners","description":"Ensure that only one banner is used on the page.","supports":1,"test":"function() {\n    let domNodes = [];\n    let banners = WebInspectorAudit.Accessibility.getElementsByComputedRole(\"banner\");\n    if (banners.length > 1)\n        domNodes = banners;\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testForLinkLabels","description":"Ensure that links have accessible labels for assistive technology.","supports":1,"test":"function() {\n    let links = WebInspectorAudit.Accessibility.getElementsByComputedRole(\"link\");\n    let domNodes = links.filter((link) => {\n        let properties = WebInspectorAudit.Accessibility.getComputedProperties(link);\n        return !properties.label && !properties.hidden;\n    });\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"aria-label\", \"aria-labelledby\", \"title\"]};\n}"},{"type":"test-case","name":"testRowGroupRoleForRequiredChildren","description":"Ensure that elements of role “rowgroup” have required owned elements in accordance with WAI-ARIA.","supports":1,"test":"function() {\n    const relationships = {\n        rowgroup: [\"row\"],\n    };\n    let domNodes = [];\n    let visitedParents = new Set;\n    function hasChildWithRole(node, expectedRoles) {\n        let childNode = node;\n        if (!childNode)\n            return false;\n\n        if (childNode.parentNode)\n            visitedParents.add(childNode.parentNode);\n\n        while (childNode) {\n            let properties = WebInspectorAudit.Accessibility.getComputedProperties(childNode);\n            if (childNode.nodeType === Node.ELEMENT_NODE && properties) {\n                if (expectedRoles.includes(properties.role))\n                    return true;\n\n                if (childNode.hasChildNodes() && hasChildWithRole(childNode.firstChild, expectedRoles))\n                    return true;\n            }\n            childNode = childNode.nextSibling;\n        }\n        return false;\n    }\n    for (let role in relationships) {\n        for (let parentNode of WebInspectorAudit.Accessibility.getElementsByComputedRole(role)) {\n            if (visitedParents.has(parentNode))\n                continue;\n\n            if (!hasChildWithRole(parentNode.firstChild, relationships[role]))\n                domNodes.push(parentNode);\n        }\n    }\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testTableRoleForRequiredChildren","description":"Ensure that elements of role “table” have required owned elements in accordance with WAI-ARIA.","supports":1,"test":"function() {\n    const relationships = {\n        table: [\"row\", \"rowgroup\"],\n    };\n    let domNodes = [];\n    let visitedParents = new Set;\n    function hasChildWithRole(node, expectedRoles) {\n        let childNode = node;\n        if (!childNode)\n            return false;\n\n        if (childNode.parentNode)\n            visitedParents.add(childNode.parentNode);\n\n        while (childNode) {\n            let properties = WebInspectorAudit.Accessibility.getComputedProperties(childNode);\n            if (childNode.nodeType === Node.ELEMENT_NODE && properties) {\n                if (expectedRoles.includes(properties.role))\n                    return true;\n\n                if (childNode.hasChildNodes() && hasChildWithRole(childNode.firstChild, expectedRoles))\n                    return true;\n            }\n            childNode = childNode.nextSibling;\n        }\n        return false;\n    }\n    for (let role in relationships) {\n        for (let parentNode of WebInspectorAudit.Accessibility.getElementsByComputedRole(role)) {\n            if (visitedParents.has(parentNode))\n                continue;\n\n            if (!hasChildWithRole(parentNode.firstChild, relationships[role]))\n                domNodes.push(parentNode);\n        }\n    }\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testForMultipleLiveRegions","description":"Ensure that only one live region is used on the page.","supports":1,"test":"function() {\n    const liveRegionRoles = [\"alert\", \"log\", \"status\", \"marquee\", \"timer\"];\n    let domNodes = [];\n    let liveRegions = liveRegionRoles.reduce((a, b) => {\n        return a.concat(WebInspectorAudit.Accessibility.getElementsByComputedRole(b));\n    }, []);\n    liveRegions = liveRegions.concat(Array.from(document.querySelectorAll(`[aria-live=\"polite\"], [aria-live=\"assertive\"]`)));\n    if (liveRegions.length > 1)\n        domNodes = liveRegions;\n    return {level: domNodes.length ? \"warn\" : \"pass\", domNodes, domAttributes: [\"aria-live\"]};\n}"},{"type":"test-case","name":"testListBoxRoleForRequiredChildren","description":"Ensure that elements of role “listbox” have required owned elements in accordance with WAI-ARIA.","supports":1,"test":"function() {\n    const relationships = {\n        listbox: [\"option\"],\n    };\n    let domNodes = [];\n    let visitedParents = new Set;\n    function hasChildWithRole(node, expectedRoles) {\n        let childNode = node;\n        if (!childNode)\n            return false;\n\n        if (childNode.parentNode)\n            visitedParents.add(childNode.parentNode);\n\n        while (childNode) {\n            let properties = WebInspectorAudit.Accessibility.getComputedProperties(childNode);\n            if (childNode.nodeType === Node.ELEMENT_NODE && properties) {\n                if (expectedRoles.includes(properties.role))\n                    return true;\n\n                if (childNode.hasChildNodes() && hasChildWithRole(childNode.firstChild, expectedRoles))\n                    return true;\n            }\n            childNode = childNode.nextSibling;\n        }\n        return false;\n    }\n    for (let role in relationships) {\n        for (let parentNode of WebInspectorAudit.Accessibility.getElementsByComputedRole(role)) {\n            if (visitedParents.has(parentNode))\n                continue;\n\n            if (!hasChildWithRole(parentNode.firstChild, relationships[role]))\n                domNodes.push(parentNode);\n        }\n    }\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testImageLabels","description":"Ensure that elements of role “img” have accessible labels for assistive technology.","supports":1,"test":"function() {\n    let images = WebInspectorAudit.Accessibility.getElementsByComputedRole(\"img\");\n    let domNodes = images.filter((image) => !WebInspectorAudit.Accessibility.getComputedProperties(image).label);\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"aria-label\", \"aria-labelledby\", \"title\", \"alt\"]};\n}"},{"type":"test-case","name":"testForAriaHiddenFalse","description":"Ensure aria-hidden=\"false\" is not used.","supports":1,"test":"function() {\n    let domNodes = Array.from(document.querySelectorAll(`[aria-hidden=\"false\"]`));\n    return {level: domNodes.length ? \"warn\" : \"pass\", domNodes, domAttributes: [\"aria-hidden\"]};\n}"},{"type":"test-case","name":"testTreeRoleForRequiredChildren","description":"Ensure that elements of role “tree” have required owned elements in accordance with WAI-ARIA.","supports":1,"test":"function() {\n    const relationships = {\n        tree: [\"treeitem\", \"group\"],\n    };\n    let domNodes = [];\n    let visitedParents = new Set;\n    function hasChildWithRole(node, expectedRoles) {\n        let childNode = node;\n        if (!childNode)\n            return false;\n\n        if (childNode.parentNode)\n            visitedParents.add(childNode.parentNode);\n\n        while (childNode) {\n            let properties = WebInspectorAudit.Accessibility.getComputedProperties(childNode);\n            if (childNode.nodeType === Node.ELEMENT_NODE && properties) {\n                if (expectedRoles.includes(properties.role))\n                    return true;\n\n                if (childNode.hasChildNodes() && hasChildWithRole(childNode.firstChild, expectedRoles))\n                    return true;\n            }\n            childNode = childNode.nextSibling;\n        }\n        return false;\n    }\n    for (let role in relationships) {\n        for (let parentNode of WebInspectorAudit.Accessibility.getElementsByComputedRole(role)) {\n            if (visitedParents.has(parentNode))\n                continue;\n\n            if (!hasChildWithRole(parentNode.firstChild, relationships[role]))\n                domNodes.push(parentNode);\n        }\n    }\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testRadioGroupRoleForRequiredChildren","description":"Ensure that elements of role “radiogroup” have required owned elements in accordance with WAI-ARIA.","supports":1,"test":"function() {\n    const relationships = {\n        radiogroup: [\"radio\"],\n    };\n    let domNodes = [];\n    let visitedParents = new Set;\n    function hasChildWithRole(node, expectedRoles) {\n        let childNode = node;\n        if (!childNode)\n            return false;\n\n        if (childNode.parentNode)\n            visitedParents.add(childNode.parentNode);\n\n        while (childNode) {\n            let properties = WebInspectorAudit.Accessibility.getComputedProperties(childNode);\n            if (childNode.nodeType === Node.ELEMENT_NODE && properties) {\n                if (expectedRoles.includes(properties.role))\n                    return true;\n\n                if (childNode.hasChildNodes() && hasChildWithRole(childNode.firstChild, expectedRoles))\n                    return true;\n            }\n            childNode = childNode.nextSibling;\n        }\n        return false;\n    }\n    for (let role in relationships) {\n        for (let parentNode of WebInspectorAudit.Accessibility.getElementsByComputedRole(role)) {\n            if (visitedParents.has(parentNode))\n                continue;\n\n            if (!hasChildWithRole(parentNode.firstChild, relationships[role]))\n                domNodes.push(parentNode);\n        }\n    }\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testFeedRoleForRequiredChildren","description":"Ensure that elements of role “feed” have required owned elements in accordance with WAI-ARIA.","supports":1,"test":"function() {\n    const relationships = {\n        feed: [\"article\"],\n    };\n    let domNodes = [];\n    let visitedParents = new Set;\n    function hasChildWithRole(node, expectedRoles) {\n        let childNode = node;\n        if (!childNode)\n            return false;\n\n        if (childNode.parentNode)\n            visitedParents.add(childNode.parentNode);\n\n        while (childNode) {\n            let properties = WebInspectorAudit.Accessibility.getComputedProperties(childNode);\n            if (childNode.nodeType === Node.ELEMENT_NODE && properties) {\n                if (expectedRoles.includes(properties.role))\n                    return true;\n\n                if (childNode.hasChildNodes() && hasChildWithRole(childNode.firstChild, expectedRoles))\n                    return true;\n            }\n            childNode = childNode.nextSibling;\n        }\n        return false;\n    }\n    for (let role in relationships) {\n        for (let parentNode of WebInspectorAudit.Accessibility.getElementsByComputedRole(role)) {\n            if (visitedParents.has(parentNode))\n                continue;\n\n            if (!hasChildWithRole(parentNode.firstChild, relationships[role]))\n                domNodes.push(parentNode);\n        }\n    }\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testTabListRoleForRequiredChildren","description":"Ensure that elements of role “tablist” have required owned elements in accordance with WAI-ARIA.","supports":1,"test":"function() {\n    const relationships = {\n        tablist: [\"tab\"],\n    };\n    let domNodes = [];\n    let visitedParents = new Set;\n    function hasChildWithRole(node, expectedRoles) {\n        let childNode = node;\n        if (!childNode)\n            return false;\n\n        if (childNode.parentNode)\n            visitedParents.add(childNode.parentNode);\n\n        while (childNode) {\n            let properties = WebInspectorAudit.Accessibility.getComputedProperties(childNode);\n            if (childNode.nodeType === Node.ELEMENT_NODE && properties) {\n                if (expectedRoles.includes(properties.role))\n                    return true;\n\n                if (childNode.hasChildNodes() && hasChildWithRole(childNode.firstChild, expectedRoles))\n                    return true;\n            }\n            childNode = childNode.nextSibling;\n        }\n        return false;\n    }\n    for (let role in relationships) {\n        for (let parentNode of WebInspectorAudit.Accessibility.getElementsByComputedRole(role)) {\n            if (visitedParents.has(parentNode))\n                continue;\n\n            if (!hasChildWithRole(parentNode.firstChild, relationships[role]))\n                domNodes.push(parentNode);\n        }\n    }\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testButtonLabels","description":"Ensure that buttons have accessible labels for assistive technology.","supports":1,"test":"function() {\n    let buttons = WebInspectorAudit.Accessibility.getElementsByComputedRole(\"button\");\n    let domNodes = buttons.filter((button) => !WebInspectorAudit.Accessibility.getComputedProperties(button).label);\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"aria-label\", \"aria-labelledby\", \"title\"]};\n}"},{"type":"test-case","name":"testRowRoleForRequiredChildren","description":"Ensure that elements of role “row” have required owned elements in accordance with WAI-ARIA.","supports":1,"test":"function() {\n    const relationships = {\n        row: [\"cell\", \"gridcell\", \"columnheader\", \"rowheader\"],\n    };\n    let domNodes = [];\n    let visitedParents = new Set;\n    function hasChildWithRole(node, expectedRoles) {\n        let childNode = node;\n        if (!childNode)\n            return false;\n\n        if (childNode.parentNode)\n            visitedParents.add(childNode.parentNode);\n\n        while (childNode) {\n            let properties = WebInspectorAudit.Accessibility.getComputedProperties(childNode);\n            if (childNode.nodeType === Node.ELEMENT_NODE && properties) {\n                if (expectedRoles.includes(properties.role))\n                    return true;\n\n                if (childNode.hasChildNodes() && hasChildWithRole(childNode.firstChild, expectedRoles))\n                    return true;\n            }\n            childNode = childNode.nextSibling;\n        }\n        return false;\n    }\n    for (let role in relationships) {\n        for (let parentNode of WebInspectorAudit.Accessibility.getElementsByComputedRole(role)) {\n            if (visitedParents.has(parentNode))\n                continue;\n\n            if (!hasChildWithRole(parentNode.firstChild, relationships[role]))\n                domNodes.push(parentNode);\n        }\n    }\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testListRoleForRequiredChildren","description":"Ensure that elements of role “list” have required owned elements in accordance with WAI-ARIA.","supports":1,"test":"function() {\n    const relationships = {\n        list: [\"listitem\", \"group\"],\n    };\n    let domNodes = [];\n    let visitedParents = new Set;\n    function hasChildWithRole(node, expectedRoles) {\n        let childNode = node;\n        if (!childNode)\n            return false;\n\n        if (childNode.parentNode)\n            visitedParents.add(childNode.parentNode);\n\n        while (childNode) {\n            let properties = WebInspectorAudit.Accessibility.getComputedProperties(childNode);\n            if (childNode.nodeType === Node.ELEMENT_NODE && properties) {\n                if (expectedRoles.includes(properties.role))\n                    return true;\n\n                if (childNode.hasChildNodes() && hasChildWithRole(childNode.firstChild, expectedRoles))\n                    return true;\n            }\n            childNode = childNode.nextSibling;\n        }\n        return false;\n    }\n    for (let role in relationships) {\n        for (let parentNode of WebInspectorAudit.Accessibility.getElementsByComputedRole(role)) {\n            if (visitedParents.has(parentNode))\n                continue;\n\n            if (!hasChildWithRole(parentNode.firstChild, relationships[role]))\n                domNodes.push(parentNode);\n        }\n    }\n    return {level: domNodes.length ? \"warn\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testComboBoxRoleForRequiredChildren","description":"Ensure that elements of role “combobox” have required owned elements in accordance with WAI-ARIA.","supports":1,"test":"function() {\n    const relationships = {\n        combobox: [\"textbox\", \"listbox\", \"tree\", \"grid\", \"dialog\"],\n    };\n    let domNodes = [];\n    let visitedParents = new Set;\n    function hasChildWithRole(node, expectedRoles) {\n        let childNode = node;\n        if (!childNode)\n            return false;\n\n        if (childNode.parentNode)\n            visitedParents.add(childNode.parentNode);\n\n        while (childNode) {\n            let properties = WebInspectorAudit.Accessibility.getComputedProperties(childNode);\n            if (childNode.nodeType === Node.ELEMENT_NODE && properties) {\n                if (expectedRoles.includes(properties.role))\n                    return true;\n\n                if (childNode.hasChildNodes() && hasChildWithRole(childNode.firstChild, expectedRoles))\n                    return true;\n            }\n            childNode = childNode.nextSibling;\n        }\n        return false;\n    }\n    for (let role in relationships) {\n        for (let parentNode of WebInspectorAudit.Accessibility.getElementsByComputedRole(role)) {\n            if (visitedParents.has(parentNode))\n                continue;\n\n            if (!hasChildWithRole(parentNode.firstChild, relationships[role]))\n                domNodes.push(parentNode);\n        }\n    }\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testForMultipleMainContentSections","description":"Ensure that only one main content section is used on the page.","supports":1,"test":"function() {\n    let domNodes = [];\n    let mainContentElements = WebInspectorAudit.Accessibility.getElementsByComputedRole(\"main\");\n    if (mainContentElements.length > 1) {\n        domNodes = mainContentElements;\n    }\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"role\"]};\n}"},{"type":"test-case","name":"testDialogsForLabels","description":"Ensure that dialogs have accessible labels for assistive technology.","supports":1,"test":"function() {\n    let dialogs = WebInspectorAudit.Accessibility.getElementsByComputedRole(\"dialog\");\n    let domNodes = dialogs.filter((dialog) => !WebInspectorAudit.Accessibility.getComputedProperties(dialog).label);\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"aria-label\", \"aria-labelledby\", \"title\"]};\n}"},{"type":"test-case","name":"testForInvalidAriaHiddenValue","description":"Ensure that values for “aria-hidden” are valid.","supports":1,"test":"function() {\n    let domNodes = Array.from(document.querySelectorAll(`[aria-hidden]:not([aria-hidden=\"true\"], [aria-hidden=\"false\"])`));\n    return {level: domNodes.length ? \"fail\" : \"pass\", domNodes, domAttributes: [\"aria-hidden\"]};\n}"}]}